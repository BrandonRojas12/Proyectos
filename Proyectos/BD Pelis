CREATE DATABASE PELIS;
USE PELIS

CREATE TABLE CUENTA(
NO_VOLUMEN INT,
ID_ESPECIFICO INT,
NO_PROVEEDOR varchar (30)
)

INSERT INTO CUENTA VALUES('001', '1', 'PELICULAS SA');
INSERT INTO CUENTA VALUES('002', '3', 'PELICULAS PATITO');
INSERT INTO CUENTA VALUES('005', ' ', 'PELICULAS PATITO');
INSERT INTO CUENTA VALUES('006', '1', 'PELICULAS PATITO');
INSERT INTO CUENTA VALUES('007', ' ', 'PELICULAS FUTURO');

SELECT * FROM CUENTA

CREATE TABLE PROVEEDOR(
NO_PROVEEDOR varchar (30),
TEL_PROVEEDOR varchar (10)
)

INSERT INTO PROVEEDOR VALUES('PELICULAS SA', ' ');
INSERT INTO PROVEEDOR VALUES('PELICULAS PATITO', '55');
INSERT INTO PROVEEDOR VALUES('PELICULAS PATITO', '66');
INSERT INTO PROVEEDOR VALUES('PELICULAS FUTURO', '66');


SELECT * FROM PROVEEDOR

CREATE TRIGGER T_EJEMPLO 
ON PROVEEDOR FOR DELETE AS
BEGIN
	DECLARE @NO_PROVEEDOR AS varchar (30)

SET @NO_PROVEEDOR = (SELECT NO_PROVEEDOR FROM deleted)

UPDATE CUENTA
SET CUENTA.NO_PROVEEDOR = PROVEEDOR.NO_PROVEEDOR
	FROM PROVEEDOR
END

DELETE FROM PROVEEDOR WHERE NO_PROVEEDOR = 'PELICULAS SA';

SELECT * FROM CUENTA
SELECT * FROM PROVEEDOR

SELECT PROVEEDOR.NO_PROVEEDOR, CUENTA.NO_VOLUMEN
FROM PROVEEDOR
INNER JOIN CUENTA ON PROVEEDOR.NO_PROVEEDOR = CUENTA.NO_PROVEEDOR
ORDER BY NO_VOLUMEN 