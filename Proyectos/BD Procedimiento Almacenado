USE MASTER
CREATE DATABASE BDEJ_PARA_PROCEDIMIENTOALMACENADO
GO
USE BDEJ_PARA_PROCEDIMIENTOALMACENADO
GO
--2.	CREA LA TABLA SALÃ“N

CREATE TABLE SALON(
CVE_SALON       		varchar(5) NOT NULL
CONSTRAINT	CK_cve_salon CHECK (CVE_SALON LIKE'[CL][BSIPL][0-4][0-9][0-9]'),
TIPO_SALON           		varchar(11) NOT NULL
CONSTRAINT	CK_tipo_salon CHECK (TIPO_SALON IN('AULA','LABORATORIO','TALLER')),
CAPACIDAD_BANCAS     	tinyint  NOT NULL
CONSTRAINT	CK_capacidad_bancas CHECK (CAPACIDAD_BANCAS BETWEEN 1 AND 80),
NO_BANCAS            		tinyint NULL
CONSTRAINT	CK_no_bancas CHECK (NO_BANCAS BETWEEN 1 AND 80)	)

--3.	CREA UN PROCEDIMIENTO PAR INSERTAR RENGLONES EN LA TABLA SALON LLAMADO SP_EJEMPLO_SALON

CREATE PROCEDURE SP_EJEMPLO_SALON
	@SALON_CLAVE 		varchar(5),
	@SALON_TIPO 		varchar(11),
	@CAPACIDADBANCAS 	tinyint,
	@NUMEROBANCAS 		tinyint
AS
INSERT INTO SALON
(CVE_SALON,TIPO_SALON,CAPACIDAD_BANCAS,NO_BANCAS)
VALUES(@SALON_CLAVE, @SALON_TIPO, @CAPACIDADBANCAS, @NUMEROBANCAS)

--4.	EJECUTA EL PROCEDIMIENTO AGREGANDO VALORES PARA LAS COLUMNAS DE SALON 
EXEC SP_EJEMPLO_SALON  'CI107','AULA',40,40

--5.	CONSULTAR LA TABLA #SALON
SELECT * FROM SALON

--6.	BORRA EL PROCEDIMIENTO ALMACENADO
DROP PROCEDURE  SP_EJEMPLO_SALON

CREATE PROCEDURE SP_EJEMPLO_SALON2
	@SALON_CLAVE 		varchar(5),
	@SALON_TIPO 		varchar(11),
	@CAPACIDADBANCAS 	tinyint
AS
INSERT INTO SALON
(CVE_SALON,TIPO_SALON,CAPACIDAD_BANCAS)
VALUES(@SALON_CLAVE, @SALON_TIPO, @CAPACIDADBANCAS)

EXEC SP_EJEMPLO_SALON2  'CB304','AULA',50

CREATE PROCEDURE SP_EJEMPLO_SALON3
	@SALON_CLAVE 		varchar(5),
	@NUMEROBANCAS 		tinyint
AS
UPDATE SALON
SET
NO_BANCAS=@NUMEROBANCAS
WHERE CVE_SALON = @SALON_CLAVE

EXEC SP_EJEMPLO_SALON3  CB304 ,"50"

CREATE PROCEDURE SP_EJEMPLO_SALON4
	@SALON_CLAVE 		varchar(5)
AS
DELETE FROM SALON
WHERE CVE_SALON = @SALON_CLAVE

EXEC SP_EJEMPLO_SALON4 CB304

SELECT * FROM SALON
