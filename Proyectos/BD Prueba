CREATE DATABASE prueba;
USE prueba

CREATE TABLE INFRACCION(
NO_BOLETA varchar(10),
NO_UNICO_LIC varchar(10),
FECHA date,
HORA datetime
)

DROP TABLE INFRACCION

CREATE TABLE CONDUCTOR(
NO_UNICO_LIC varchar(10),
NOMBRE_COND varchar(10)
)

INSERT INTO INFRACCION VALUES('102', '1012', '12/01/2020', '13:00');
INSERT INTO INFRACCION VALUES('105', '1102', '11/11/2019', '12:00');
INSERT INTO INFRACCION VALUES('145', '2112', '01/12/2021', '16:00');
INSERT INTO INFRACCION VALUES('100', '2648', '08/30/2022', '23:00');

SELECT * FROM INFRACCION

INSERT INTO CONDUCTOR VALUES('1012', 'Rodrigo');
INSERT INTO CONDUCTOR VALUES('1102', 'Miguel');
INSERT INTO CONDUCTOR VALUES('2112', 'Pedro');
INSERT INTO CONDUCTOR VALUES('2648', 'Antonio');

SELECT * FROM CONDUCTOR


CREATE VIEW EJEMPLO_VISTA AS
SELECT I.NO_BOLETA, I.FECHA, I.HORA, C.NO_UNICO_LIC, C.NOMBRE_COND
FROM INFRACCION AS I INNER JOIN CONDUCTOR AS C ON I.NO_UNICO_LIC = C.NO_UNICO_LIC

DROP VIEW EJEMPLO_VISTA

SELECT * FROM EJEMPLO_VISTA
ORDER BY HORA, FECHA;

CREATE NONCLUSTERED INDEX EJEMPLO_INDICE
ON CONDUCTOR (NOMBRE_COND)

EXECUTE sp_helpindex 'CONDUCTOR'

SELECT NOMBRE_COND FROM CONDUCTOR

CREATE TABLE OFICIAL(
NOMBRE varchar(10),
RANGO varchar(10),
DEPARTAMENTO varchar (10)
)

INSERT INTO OFICIAL VALUES('Sergio', 'Oficial', 'Transito');
INSERT INTO OFICIAL VALUES('Raul', 'Capitan', 'Bancaria');
INSERT INTO OFICIAL VALUES('Jose', 'Inspector', 'PDI');
INSERT INTO OFICIAL VALUES('Juan', 'Policia', 'Auxiliar');

SELECT * FROM OFICIAL

USE prueba
GO
CREATE PROC SP_ACT_OFC_EXP
@NOMBRE varchar(10),
@RANGO varchar(10),
@DEPARTAMENTO varchar (10)
AS 
BEGIN
UPDATE OFICIAL
 SET RANGO= @RANGO, 
     DEPARTAMENTO= @DEPARTAMENTO
 WHERE NOMBRE=@NOMBRE
END

EXEC SP_ACT_OFC_EXP Sergio, 'Comandante', 'Auxiliar' 

