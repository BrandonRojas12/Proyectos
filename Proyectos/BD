USE CE

SELECT NOMBRE_ALUMNO, PRIMER_DEP, CVE_SECUENCIA, U_APRENDIZAJE.CVE_UAP FROM ALUMNO
INNER JOIN CALIFICACIONES_SEMESTRE ON CALIFICACIONES_SEMESTRE.BOLETA = ALUMNO.BOLETA
INNER JOIN U_APRENDIZAJE ON CALIFICACIONES_SEMESTRE.CVE_UAP = U_APRENDIZAJE.CVE_UAP
WHERE (PRIMER_DEP BETWEEN 8 AND 10) OR CVE_SECUENCIA = '3CM51' OR U_APRENDIZAJE.CVE_UAP = 'C304'

SELECT CVE_SECUENCIA, GRUPO.CVE_UAP, U_APRENDIZAJE.NOMBRE_U_AP FROM GRUPO
INNER JOIN U_APRENDIZAJE ON GRUPO.CVE_UAP = U_APRENDIZAJE.CVE_UAP
WHERE CVE_SECUENCIA = '4NV71' OR CVE_SECUENCIA = '3CM51' 

 SELECT CVE_UAP, NOMBRE_U_AP, CREDITOS_UAP, PERIODO_UAP, CVE_CARRERA FROM U_APRENDIZAJE 
 WHERE CVE_CARRERA ='N'
 ORDER BY PERIODO_UAP ASC

SELECT GRUPO.CVE_UAP, NOMBRE_U_AP, PROFESOR.NOMBRE_PROFESOR, HORA_CLASE.DIA, HORA_CLASE.HORA_INICIO, HORA_CLASE.HORA_FIN  FROM GRUPO 
RIGHT OUTER JOIN HORA_CLASE ON HORA_CLASE.CVE_UAP = GRUPO.CVE_UAP
INNER JOIN U_APRENDIZAJE ON  U_APRENDIZAJE.CVE_UAP = GRUPO.CVE_UAP
INNER JOIN PROFESOR ON PROFESOR.NO_PROFESOR = GRUPO.NO_PROFESOR

SELECT NOMBRE_ALUMNO, U_APRENDIZAJE.CVE_UAP, U_APRENDIZAJE.NOMBRE_U_AP, PRIMER_DEP, SEGUNDO_DEP, TERCER_DEP FROM ALUMNO
INNER JOIN CALIFICACIONES_SEMESTRE ON CALIFICACIONES_SEMESTRE.BOLETA = ALUMNO.BOLETA
INNER JOIN U_APRENDIZAJE ON U_APRENDIZAJE.CVE_UAP = CALIFICACIONES_SEMESTRE.CVE_UAP 
WHERE ALUMNO.BOLETA = '2016601872' AND CALIFICACIONES_SEMESTRE.BOLETA = '2016601872'
ORDER BY PERIODO_UAP ASC

SELECT * FROM HORA_CLASE WHERE CVE_SALON_LAB IS NULL

SELECT GRUPO.CVE_SECUENCIA, GRUPO.NO_PROFESOR, HORA_CLASE.CVE_SALON_LAB  FROM GRUPO 
INNER JOIN PROFESOR ON GRUPO.NO_PROFESOR = PROFESOR.NO_PROFESOR
INNER JOIN HORA_CLASE ON GRUPO.CVE_SECUENCIA = HORA_CLASE.CVE_SECUENCIA
WHERE GRUPO.NO_PROFESOR IS NULL OR CVE_SALON_LAB IS NULL

SELECT NOMBRE_ALUMNO, U_APRENDIZAJE.NOMBRE_U_AP, PROFESOR.NOMBRE_PROFESOR, PROFESOR.ACADEMIAS FROM ALUMNO
INNER JOIN U_APRENDIZAJE ON ALUMNO.CVE_CARRERA = U_APRENDIZAJE.CVE_CARRERA
INNER JOIN GRUPO ON U_APRENDIZAJE.CVE_UAP = GRUPO.CVE_UAP
INNER JOIN PROFESOR ON GRUPO.NO_PROFESOR = PROFESOR.NO_PROFESOR
WHERE BOLETA = '2016601872'

SELECT CVE_UAP, CVE_SECUENCIA, PROFESOR.NOMBRE_PROFESOR FROM GRUPO
LEFT OUTER JOIN PROFESOR ON GRUPO.NO_PROFESOR = PROFESOR.NO_PROFESOR

SELECT BOLETA, NOMBRE_ALUMNO, U_APRENDIZAJE.CVE_UAP, U_APRENDIZAJE.NOMBRE_U_AP, PROFESOR.NOMBRE_PROFESOR, HORA_CLASE.CVE_SALON_LAB, HORA_CLASE.DIA, HORA_CLASE.HORA_INICIO, HORA_CLASE.HORA_FIN FROM ALUMNO
INNER JOIN U_APRENDIZAJE ON U_APRENDIZAJE.CVE_CARRERA = ALUMNO.CVE_CARRERA
INNER JOIN GRUPO ON GRUPO.CVE_UAP = U_APRENDIZAJE.CVE_UAP
INNER JOIN PROFESOR ON PROFESOR.NO_PROFESOR = GRUPO.NO_PROFESOR
RIGHT OUTER JOIN HORA_CLASE ON HORA_CLASE.CVE_UAP = U_APRENDIZAJE.CVE_UAP
WHERE BOLETA LIKE '2015%'

SELECT BOLETA, NOMBRE_ALUMNO, COUNT(GRUPO.CVE_SECUENCIA) AS SECUENCIAS, COUNT (GRUPO.CVE_UAP) AS UNIDADES_APRENDIZAJE  FROM ALUMNO
INNER JOIN U_APRENDIZAJE ON U_APRENDIZAJE.CVE_CARRERA = ALUMNO.CVE_CARRERA
INNER JOIN GRUPO ON GRUPO.CVE_UAP = U_APRENDIZAJE.CVE_UAP
GROUP BY BOLETA, NOMBRE_ALUMNO

INSERT INTO HISTORIAL_ALUMNO (BOLETA, CVE_SECUENCIA_H, CVE_UAP_H, CVE_PERIODO, CALIFICACION_HISTORIAL) VALUES ('2016601872', '4NV41', 'N21-N407', '2016-1', '8')

UPDATE CALIFICACIONES_SEMESTRE
SET EXTRAORDINARIO = 7
WHERE BOLETA = '2016601872'

SELECT NOMBRE_ALUMNO, U_APRENDIZAJE.CVE_UAP, U_APRENDIZAJE.NOMBRE_U_AP, CALIFICACIONES_SEMESTRE.PRIMER_DEP, CALIFICACIONES_SEMESTRE.SEGUNDO_DEP, CALIFICACIONES_SEMESTRE.TERCER_DEP, PERIODO.CVE_PERIODO
FROM ALUMNO
INNER JOIN U_APRENDIZAJE ON U_APRENDIZAJE.CVE_CARRERA = ALUMNO.CVE_CARRERA
INNER JOIN CALIFICACIONES_SEMESTRE ON CALIFICACIONES_SEMESTRE.BOLETA = ALUMNO.BOLETA
INNER JOIN HISTORIAL_ALUMNO ON HISTORIAL_ALUMNO.BOLETA = ALUMNO.BOLETA
INNER JOIN PERIODO ON PERIODO.CVE_PERIODO = HISTORIAL_ALUMNO.CVE_PERIODO
WHERE ALUMNO.BOLETA = '2016601872'


SELECT * FROM U_APRENDIZAJE
SELECT * FROM CALIFICACIONES_SEMESTRE WHERE BOLETA ='2016601872'
SELECT * FROM GRUPO
SELECT * FROM ALUMNO WHERE BOLETA ='2016601872'
SELECT * FROM PERIODO
SELECT * FROM CARRERA
SELECT * FROM HORA_CLASE
SELECT * FROM PROFESOR
SELECT * FROM SECUENCIA
SELECT * FROM SALON_LAB
SELECT * FROM GRUPO
SELECT * FROM HISTORIAL_ALUMNO